{% extends 'layout.html' %}
{% block content %}

{% if model.referer %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <a href="{{ model.referer }}" class="govuk-back-link govuk-!-margin-bottom-7">Back</a>
  </div>
</div>
{% endif %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-xl govuk-!-margin-bottom-2">
      {% if model.flood %}
      {{ model.severity.title }}: {{model.area.name}}
      {% else %}
      {{model.area.name}} flood risk area
      {% endif %}
    </h1>
    {% if model.flood %}
    <p class="govuk-body-s govuk-!-margin-bottom-7">Updated:
      {% if model.severity.isActive %}
      <time datetime="{{model.flood.severityChanged}}">{{model.flood.severityChanged | formatDate}}</time>
      {% else %}
      <time datetime="{{model.flood.messageChanged}}">{{model.flood.messageChanged | formatDate}}</time>
      {% endif %}
    </p>
    {% else %}
    <p class="govuk-!-margin-top-7">No flood alert or warning currently in force.</p>
    {% endif %}

    <!--<p class="govuk-body-l govuk-!-margin-bottom-2">{{model.area.description}}</p>-->

    {% if model.flood %}
      {% if model.severity.isActive %}
        <div class="defra-warning-text-flood defra-warning-text-flood--{{ model.severity.hash.toLowerCase() }} govuk-!-margin-bottom-6">
          <span class="defra-warning-text-flood__icon"></span>
          <strong class="defra-warning-text-flood__text">
            <span class="govuk-visually-hidden">{{ model.severity.title }}</span>
              {{ model.severity.subTitle }}<!-- - be prepared -->
          </strong>
        </div>
      {% endif %}
      <p class="govuk-body">{{model.flood.message}}</p>
    {% endif %}

    <div class="app-map">
      <div class="app-map__container">
        <figure class="map" id="map-live">
          <div class="map__container">
            <div class="map__container-inner"></div>
          </div>
          <figcaption class="govuk-visually-hidden">Flood warnings and river and sea levels</figcaption>
        </figure>
      </div>
    </div>

    {% if model.flood %}
    <p class="govuk-body">Could this information be better? <a href="/target-area/{{model.area.code}}/feedback">Tell us how to improve it</a>.</p>
    {% endif %}

    {% if model.flood and model.severity.isActive %}
    <div class="govuk-inset-text">
      {% if model.severity.hash == 'severe-flood-warning' %}
      You <a href="/what-to-do-in-a-flood/getting-a-severe-flood-warning">must act now</a> if you live in this area.
      {% elif model.severity.hash == 'flood-warning' %}
      You need to <a href="/what-to-do-in-a-flood/getting-a-flood-warning">take action</a> if you live in this area.
      {% else %}
      <a href="/what-to-do-in-a-flood/getting-a-flood-alert">Be prepared</a> if you live in this area
      {% endif %}
    </div>
    {% endif %}

    <h2 class="govuk-heading-m">Other ways to check your current flood risk</h2>
    <p class="govuk-body"><a href="https://www.gov.uk/find-local-council">Contact your local council</a> if you are not sure of the source of flooding.</p>
    <p class="govuk-body">For river and sea flooding, call the 24-hour Floodline service.</p>
    <p class="govuk-body">
      Telephone: 0345 988 1188<br />
      Type talk: 0345 602 6340 (for the hard of hearing)<br />
      <a class="govuk-link" href="https://gov.uk/call-charges">Find out more about call charges</a>.
    </p>
  </div>

  <div class="govuk-grid-column-one-third">
    <!-- The Related items component is not part of GOV.UK Frontend but will be styled if used in the Prototype Kit -->
    <aside class="app-related-items" role="complementary" style="border-width:2px">
      <h2 class="govuk-heading-s" id="subsection-title">
        Related content
      </h2>
      <nav role="navigation" aria-labelledby="subsection-title">
        <ul class="govuk-list govuk-!-font-size-16">
          <li>
            <a class="govuk-link" href="/plan-ahead-for-flooding">
              How to plan ahead for flooding
            </a>
          </li>
          <li>
            <a class="govuk-link" href="/what-to-do-in-a-flood/what-the-flood-warnings-mean">
              What to do in a flood
            </a>
          </li>
          <li>
            <a class="govuk-link" href="/recovering-after-a-flood">
              How to recover after a flood
            </a>
          </li>
          <li>
            <a class="govuk-link" href="#">
              View long term flood risk information
            </a>
          </li>
        </ul>
      </nav>
    </aside>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    {% include "partials/social.html" %}
  </div>
</div>

{% endblock %}

{% block bodyEnd %}
{{ super() }}
<script src="{{assetPath}}/javascripts/ol.js"></script>
  <script src="{{assetPath}}/javascripts/components/maps.js"></script>
  <script src="{{assetPath}}/javascripts/components/maps-styles.js"></script>
  <script src="{{assetPath}}/javascripts/components/maps-layers.js"></script>
  <script src="{{assetPath}}/javascripts/components/map-container.js"></script>
  <script src="{{assetPath}}/javascripts/components/maps/live.js"></script>
  <script src="{{assetPath}}/javascripts/templates.js"></script>
  <script src="{{ assetPath }}/nunjucks-slim.min.js"></script>
  <script>nunjucks.configure()</script>
<script>
  window.flood.model = {{ model | dump(2) | safe }}
</script>
<script src="{{assetPath}}/javascripts/pages/target-area.js"></script>
{% endblock %}
