{% extends 'layout.html' %}
{% block content %}

{% if model.referer %}
<div class="govuk-grid-row">
    <div class="govuk-grid-column-full" id="browserBackContainer"></div>
</div>
{% endif %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

<!--    FIRST BANNER-->
    <div class="defra-flood-status govuk-!-margin-bottom-3">
      {% if model.flood and model.severity.id < 4%}
      <div class="defra-flood-status-item defra-flood-status-item--{{model.severity.hash}}">
        <span class="defra-flood-status-item__icon"></span>
        <div class="defra-flood-status-item__text">
          <strong>{{model.severity.subTitle}} - <a class="govuk-link" href="{{model.severity.actionLink}}">{{model.severity.tagline}}</a></strong>
        </div>
      </div>
      {% endif %}

<!--      Inactive or Removed and there is no active alert in parent area-->
      {% if ((model.flood and model.severity.id == 4) or not model.flood) and not model.parentAreaAlert%}
        <div class="defra-flood-status-item">
          {% if not model.flood %}
          <div class="defra-flood-status-item__text">
            The flood {% if model.area.code.slice(4,5).toLowerCase() == 'w'%}warning{% else %}alert{% endif %} was removed
          </div>
          {% else %}
          <div class="defra-flood-status-item__text">
            There are no flood {% if model.area.code.slice(4,5).toLowerCase() == 'w'%}warnings{% else %}alerts{% endif %} in this area
          </div>
          {% endif %}
        </div>
      {% endif %}
    </div>

<!--    Second banner appearing in case of active alert in parent area-->
    {% if model.parentAreaAlert %}
    <div class="defra-flood-status govuk-!-margin-bottom-3">
      <div class="defra-flood-status-item defra-flood-status-item--alert">
        <span class="defra-flood-status-item__icon"></span>
        <div class="defra-flood-status-item__text">
          {% if not model.flood %}
          The flood warning was removed, but there's still <a href="/target-area/{{model.area.parent}}">a flood alert in the wider area</a>
          {% else %}
          There are no flood warnings in this area, but there is <a href="/target-area/{{model.area.parent}}">a flood alert in the wider area</a>
          {% endif %}
        </div>
      </div>
    </div>
    {% endif %}

    <h1 class="govuk-heading-xl">{{ model.pageTitle }}</h1>

  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <p>
     {{model.situation}}
    </p>

    <p class="defra-flood-meta defra-flood-meta--border govuk-!-margin-top-6 govuk-!-margin-bottom-6">
      <time datetime="{{model.situationChanged}}">{{model.situationChanged}}</time>
    </p>

    <p>{{model.areaDescription}}</p>
    <div class="defra-map" id="map-live"></div>
    
    {% if model.flood and model.severity.isActive %}
    <div class="govuk-inset-text govuk-!-margin-top-2">
      {% if model.severity.id === 3 %}
      A severe flood warning means there is a danger to life. <a href="/what-to-do-in-a-flood#what-to-do-if-you-get-a-severe-flood-warning">Find out what to do in you get a severe flood warning</a>.
      {% elif model.severity.id == 2 %}
      A flood warning means flooding is expected and you need to act now. <a href="/what-to-do-in-a-flood#what-to-do-if-you-get-a-flood-warning">Find out what to do in you get a flood warning</a>.
      {% else %}
      A flood alert means flooding is possible and you need to be prepared. <a href="/what-to-do-in-a-flood#what-to-do-if-you-get-a-flood-alert">Find out what to do if you get a flood alert</a>.
      {% endif %}
    </div>
    {% endif %}
    <p><a href="https://www.gov.uk/sign-up-for-flood-warnings">Get flood warnings by phone, text or email.</a></p>
    <h2 class="govuk-heading-m">Check river, sea or groundwater levels</h2>
    <p>They can give you a better understanding of your flood risk.</p>
    <p><a href="/river-and-sea-levels?target-area={{ model.targetArea }}">Find a river, sea or groundwater level in this area.</a></p>
  
  {% include "partials/context-footer.html" %}

  </div>

  <div class="govuk-grid-column-one-third">
   {% include "partials/related-content.html" %}
  </div>
</div>

{% endblock %}

{% block bodyEnd %}
{{ super() }}
<script>
  window.flood.model = {{ model | dump(2) | safe }}
</script>
<script src="{{assetPath}}/js/templates.js"></script>
<script src="{{assetPath}}/js/target-area.js"></script>
{% endblock %}
