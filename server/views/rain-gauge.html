{% extends 'layout.html' %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <a href="" onclick="window.history.back();return false" class="govuk-back-link govuk-!-margin-bottom-7">Back</a>
    <h1 class="govuk-heading-xl">
      <span class="govuk-caption-xl">Rain gauge at grid ref</span>
      {{ model.gridRef }}
    </h1>
  </div>
</div>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <div class="govuk-tabs" data-module="tabs">
      <h2 class="govuk-tabs__title">
        Contents
      </h2>
      <ul class="govuk-tabs__list">
        <li class="govuk-tabs__list-item">
          <a class="govuk-tabs__tab govuk-tabs__tab--selected" href="#six-hours">
            6 hours
          </a>
        </li>
        <li class="govuk-tabs__list-item">
          <a class="govuk-tabs__tab" href="#one-day">
            1 day
          </a>
        </li>
        <li class="govuk-tabs__list-item">
          <a class="govuk-tabs__tab" href="#four-weeks">
            4 weeks
          </a>
        </li>
      </ul>
      <section class="govuk-tabs__panel" id="six-hours">
        <figure class="defra-bar-chart">
          <figcaption class="defra-bar-chart__caption">
            Rainfall measured at 15 minute intervals over the latest 6 hours
          </figcaption>
          <div class="defra-bar-chart__inner">
            <table class="defra-bar-chart__table">
              <thead>
                <tr>
                  <th scope="col">15 minute period</th>
                  <th scope="col">Measurement</th>
                </tr>
              </thead>
              <tbody>
                {% for column in model.graphMinutes.columns %}
                <tr>
                  <td class="{% if column.isTick %}defra-bar-chart__h-tick{% else %}govuk-visually-hidden{% endif %}" style="width:{{ column.hWidthPercentile * 4 }}%;left:{{ column.hPercentile - (column.hWidthPercentile * 1.5) }}%">
                    <span class="govuk-body-s">
                      <time datetime="{{ column.timestamp }}">{{ column.period }}</time>
                    </span>
                  </td>
                  <td class="{% if column.value %}defra-bar-chart__h-value{% else %}govuk-visually-hidden{% endif %}" style="width:{{ column.hWidthPercentile }}%;left:{{ column.hPercentile }}%;height:{{ column.vPercentile }}%">
                    <span class="defra-bar-chart__h-value-inner">{{ column.value }}mm</span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
              <tfoot aria-hidden="true">
                <tr class="defra-bar-chart__v-axis">
                  {% for i in range(0, model.graphMinutes.vTicksCount) -%}
                  <td class="defra-bar-chart__v-tick" style="bottom:{{ i * model.graphMinutes.vTickPercentile }}%">
                    <span class="defra-bar-chart__v-tick-label">{{ i * model.graphMinutes.vTickValue }}mm</span>
                  </td>
                  {%- endfor %}
                  {% if model.graphMinutes.threshold %}
                  <td class="defra-bar-chart__v-threshold" style="bottom:{{ model.graphMinutes.thresholdPercentile }}%">
                    <span class="govuk-visually-hidden">{{ model.graphMinutes.threshold }}mm</span>
                  </td>
                  {% endif %}
                </tr>
              </tfoot>
            </table>
            <div class="defra-bar-chart__legend" style="bottom:{{ model.graphMinutes.thresholdPercentile }}%">
              <div class="defra-bar-chart__legend--inner">
                <!--
                Average daily rainfall for January<span class="govuk-visually-hidden"> is {{ model.graphMinutes.threshold }}mm.</span>
                -->
                Heavy rainfall level<span class="govuk-visually-hidden"> is defined here as above {{ model.graphMinutes.threshold }}mm in 15 minutes.</span>
              </div>
            </div>
          </div>
        </figure>
      </section>
      <section class="govuk-tabs__panel govuk-tabs__panel--hidden" id="one-day">
        <figure class="defra-bar-chart">
          <figcaption class="defra-bar-chart__caption">
            Hourly rainfall measurements for the latest 24 hours
          </figcaption>
          <div class="defra-bar-chart__inner">
            <table class="defra-bar-chart__table">
              <thead>
                <tr>
                  <th scope="col">Hourly period</th>
                  <th scope="col">Measurement</th>
                </tr>
              </thead>
              <tbody>
                {% for column in model.graphHours.columns %}
                <tr>
                  <td class="{% if column.isTick %}defra-bar-chart__h-tick{% else %}govuk-visually-hidden{% endif %}" style="width:{{ column.hWidthPercentile * 4 }}%;left:{{ column.hPercentile - (column.hWidthPercentile * 1.5) }}%">
                    <span class="govuk-body-s">
                      <time datetime="{{ column.timestamp }}">{{ column.period }}</time>
                    </span>
                  </td>
                  <td class="{% if column.value %}defra-bar-chart__h-value{% else %}govuk-visually-hidden{% endif %}" style="width:{{ column.hWidthPercentile }}%;left:{{ column.hPercentile }}%;height:{{ column.vPercentile }}%">
                    <span class="defra-bar-chart__h-value-inner">{{ column.value }}mm</span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
              <tfoot aria-hidden="true">
                <tr class="defra-bar-chart__v-axis">
                  {% for i in range(0, model.graphHours.vTicksCount) -%}
                  <td class="defra-bar-chart__v-tick" style="bottom:{{ i * model.graphHours.vTickPercentile }}%">
                    <span class="defra-bar-chart__v-tick-label">{{ i * model.graphHours.vTickValue }}mm</span>
                  </td>
                  {%- endfor %}
                  {% if model.graphHours.threshold %}
                  <td class="defra-bar-chart__v-threshold" style="bottom:{{ model.graphHours.thresholdPercentile }}%">
                    <span class="govuk-visually-hidden">{{ model.graphHours.threshold }}mm</span>
                  </td>
                  {% endif %}
                </tr>
              </tfoot>
            </table>
            <div class="defra-bar-chart__legend" style="bottom:{{ model.graphHours.thresholdPercentile }}%">
              <div class="defra-bar-chart__legend--inner">
                <!--
                Average daily rainfall for January<span class="govuk-visually-hidden"> is {{ model.graphHours.threshold }}mm.</span>
                -->
                Heavy rainfall level<span class="govuk-visually-hidden"> is defined here as above {{ model.graphHours.threshold }}mm in 15 minutes.</span>
              </div>
            </div>
          </div>
        </figure>
      </section>
      <section class="govuk-tabs__panel govuk-tabs__panel--hidden" id="four-weeks">
        <figure class="defra-bar-chart">
          <figcaption class="defra-bar-chart__caption">
            Daily rainfall measurements for the 4 weeks
          </figcaption>
          <div class="defra-bar-chart__inner">
            <table class="defra-bar-chart__table">
              <thead>
                <tr>
                  <th scope="col">Day</th>
                  <th scope="col">Measurement</th>
                </tr>
              </thead>
              <tbody>
                {% for column in model.graphDays.columns %}
                <tr>
                  <td class="{% if column.isTick %}defra-bar-chart__h-tick{% else %}govuk-visually-hidden{% endif %}" style="width:{{ column.hWidthPercentile * 4 }}%;left:{{ column.hPercentile - (column.hWidthPercentile * 1.5) }}%">
                    <span class="govuk-body-s">
                      <time datetime="{{ column.timestamp }}">{{ column.period }}</time>
                    </span>
                  </td>
                  <td class="{% if column.value %}defra-bar-chart__h-value{% else %}govuk-visually-hidden{% endif %}" style="width:{{ column.hWidthPercentile }}%;left:{{ column.hPercentile }}%;height:{{ column.vPercentile }}%">
                    <span class="defra-bar-chart__h-value-inner">{{ column.value }}mm</span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
              <tfoot aria-hidden="true">
                <tr class="defra-bar-chart__v-axis">
                  {% for i in range(0, model.graphDays.vTicksCount) -%}
                  <td class="defra-bar-chart__v-tick" style="bottom:{{ i * model.graphHours.vTickPercentile }}%">
                    <span class="defra-bar-chart__v-tick-label">{{ i * model.graphDays.vTickValue }}mm</span>
                  </td>
                  {%- endfor %}
                  {% if model.graphDays.threshold %}
                  <td class="defra-bar-chart__v-threshold" style="bottom:{{ model.graphDays.thresholdPercentile }}%">
                    <span class="govuk-visually-hidden">{{ model.graphDays.threshold }}mm</span>
                  </td>
                  {% endif %}
                </tr>
              </tfoot>
            </table>
            <div class="defra-bar-chart__legend" style="bottom:{{ model.graphDays.thresholdPercentile }}%">
              <div class="defra-bar-chart__legend--inner">
                <!--
                Average daily rainfall for January<span class="govuk-visually-hidden"> is {{ model.graphDays.threshold }}mm.</span>
                -->
                Heavy rainfall level<span class="govuk-visually-hidden"> is defined here as above {{ model.graphDays.threshold }}mm in 15 minutes.</span>
              </div>
            </div>
          </div>
        </figure>
      </section>
    </div>
  </div>
</div>
{% endblock %}

{% block bodyEnd %}
{{ super() }}
<script src="{{ assetPath }}/nunjucks-slim.min.js"></script>
<script>nunjucks.configure()</script>
<script>
  window.flood.model = {{ model | dump(2) | safe }}
</script>
<script src="{{assetPath}}/javascripts/pages/rain-gauge.js"></script>
{% endblock %}
