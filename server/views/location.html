{% extends 'layout.html' %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <nav class="govuk-!-margin-bottom-7">
      <p>
        <a href="/">Change location</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="/national">National view</a>
      </p>
    </nav>
    <h1 class="govuk-heading-xl govuk-!-margin-bottom-2">
      Flood risk: {{ model.location }}
    </h1>
    <p class="defra-updated govuk-!-margin-bottom-7">
      Updated at <time datetime="{{model.timestamp}}">{{ model.timestamp | formatDate }}</time>
    </p>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
   
    <div class="defra-flood-status govuk-!-margin-bottom-1">
      {% if model.hasActiveFloods %}
      <div class="defra-flood-status-item defra-flood-status-item--{{model.highestSeverity.hash}}">
        <span class="defra-flood-status-item__icon">
          <span class="govuk-visually-hidden">{{model.highestSeverity.title}}</span>
        </span>
        <div class="defra-flood-status-item__text">
          <strong>
              {% if model.highestSeverity.id == 1 %}
              {{model.highestSeverity.subTitle}}
              {% else %}
              Some {{model.highestSeverity.subTitle | lower}}
              {% endif %}
          </strong>
        </div>
      </div>
      {% else %}
      <div class="defra-flood-status-item">
        <div class="defra-flood-status-item__text">
          No flood warnings or alerts currently in place in this area. 
          {% if model.hasHighLevels %}
          However some <a href="/river-and-sea-levels?q={{ model.q }}">river and sea levels</a> are currently high.
          {% endif %}
        </div>
      </div>
      {% endif %}
    </div>
    
    {% if model.hasFloods %}
    <p class="govuk-body">
      {{ model.floodSummary | safe }}
    </p>
    {% endif %}

    <p class="govuk-body">If you live near a river or the coast you may be able to <a href="https://www.gov.uk/sign-up-for-flood-warnings">get flood warnings by phone, text or email</a>. This service is free.</p>

    {% if model.hasActiveImpacts %}
    <p class="govuk-body">
      Historic records show <a href="/historic-impacts?q={{ model.q }}">{{ model.activeImpacts.length }} flood impact{% if model.activeImpacts.length > 1 %}s{% endif %}</a> in this area when river and sea levels previously reached their current height.
    </p>
    {% endif %}

    {% if model.hasLevels and not(not model.hasActiveFloods and model.hasHighLevels) %}
    <p class="govuk-body">
      {% if not model.hasFloods and not model.hasHighLevels %}
      River and sea levels are regularly checked by a network of monitoring stations. These levels can help you understand flood risk now and in the next few days.
      {% endif %}
      <a href="/river-and-sea-levels?q={{ model.q }}">View river and sea levels in this area</a>.
    </p>
    {% endif %}

    <h2 class="govuk-heading-m">Report a flood</h2>
    <p class="govuk-body">Flooding can also be caused by surface water, burst water mains or overflowing drains. You can <a href="https://www.gov.uk/report-flood-cause">report a flood or possible cause of flooding</a>.</p>

    <h2 class="govuk-heading-m">Other ways to check your current flood risk</h2>
    <p class="govuk-body"><a href="https://www.gov.uk/find-local-council">Contact your local council</a> if you are not sure of the source of flooding.</p>
    <p class="govuk-body">For river and sea flooding, call the 24-hour Floodline service.</p>
    <p class="govuk-body">
      Telephone: 0345 988 1188<br />
      Type talk: 0345 602 6340 (for the hard of hearing)<br />
      <a class="govuk-link" href="https://gov.uk/call-charges">Find out more about call charges</a>.
    </p>
  </div>
  <div class="govuk-grid-column-one-third">
    <!-- The Related items component is not part of GOV.UK Frontend but will be styled if used in the Prototype Kit -->
    <aside class="defra-related-items" role="complementary">
      <h2 class="govuk-heading-s" id="subsection-title">
        Related content
      </h2>
      <nav role="navigation" aria-labelledby="subsection-title">
        <ul class="govuk-list govuk-!-font-size-16">
          <li>
            <a class="govuk-link" href="/plan-ahead-for-flooding">
              How to plan ahead for flooding
            </a>
          </li>
          <li>
            <a class="govuk-link" href="/what-to-do-in-a-flood">
              What to do in a flood
            </a>
          </li>
          <li>
            <a class="govuk-link" href="/recovering-after-a-flood">
              How to recover after a flood
            </a>
          </li>
          <li>
            <a class="govuk-link" href="#">
              View long term flood risk information
            </a>
          </li>
        </ul>
      </nav>
    </aside>
  </div>
</div>

{% endblock %}

{% block bodyEnd %}
  {{ super() }}
  <script src="{{assetPath}}/javascripts/ol.js"></script>
  <script src="{{assetPath}}/javascripts/components/maps.js"></script>
  <script src="{{assetPath}}/javascripts/components/maps-styles.js"></script>
  <script src="{{assetPath}}/javascripts/components/maps-layers.js"></script>
  <script src="{{assetPath}}/javascripts/components/map-container.js"></script>
  <script src="{{assetPath}}/javascripts/components/maps/live.js"></script>
  <script src="{{assetPath}}/javascripts/templates.js"></script>
  <script src="{{ assetPath }}/nunjucks-slim.min.js"></script>
  <script>nunjucks.configure()</script>
  <script>
    window.flood.model = {{ model | dump(2) | safe }}
  </script>
  <script src="{{assetPath}}/javascripts/pages/location.js"></script>
{% endblock %}