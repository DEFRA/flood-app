{% extends 'layout.html' %}

{% macro severity(panel) %}
<div class="accordion__section" id="{{panel.name}}">
  <div class="accordion__section-container">
    <div class="accordion__section-header">
      <h2 class="accordion__section-title">
        {{panel.title}}
      </h2>
      <p class="accordion__description">{{panel.description}}</p>
    </div>
    <div class="accordion__section-content" id="{{panel.name}}-content">
    </div>
  </div>
</div>
{% endmacro %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-xl govuk-!-margin-bottom-2">Flood risk for England</h1>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <div class="defra-warning-overview govuk-!-margin-top-0">
      <h2 class="govuk-heading-m govuk-!-margin-bottom-4 govuk-!-margin-top-6">
        Current flood warnings and alerts
      </h2>

      {% for panel in model.panels %}
        <div class="defra-warning-overview__section">
          <h3 class="defra-warning-overview__section-title">
            <span class="defra-warning-overview__icon defra-warning-overview__icon--{{ panel.severity.id }}"></span>
            {{ panel.title }}
            <span class="govuk-caption-m">{{ panel.severity.tagline }}</span>
          </h3>
        </div>
      {% endfor %}
      <!-- <div class="defra-warning-overview__section">
        <h3 class="defra-warning-overview__section-title">
          <span class="defra-warning-overview__icon defra-warning-overview__icon--warning"></span>
          6 Flood warnings
          <span class="govuk-caption-m">Flooding is expected</span>
        </h3>
      </div>
      <div class="defra-warning-overview__section">
        <h3 class="defra-warning-overview__section-title">
          <span class="defra-warning-overview__icon defra-warning-overview__icon--alert"></span>
          34 Flood alerts
          <span class="govuk-caption-m">Flooding is possible</span>
        </h3>
      </div>
      <div class="defra-warning-overview__section">
        <h3 class="defra-warning-overview__section-title">
          <span class="defra-warning-overview__icon defra-warning-overview__icon--removed"></span>
          34 Warnings removed
          <span class="govuk-caption-m">Within the last 24hrs</span>
        </h3>
      </div> -->
    </div>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <div id="warnings" class="govuk-!-margin-bottom-4">
      <details class="govuk-details">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">
            View list of flood warnings
          </span>
        </summary>
        <div class="govuk-details__text">
          {% for panel in model.panels %}
            {% if panel.floods %}
              <h3 class="govuk-heading-s govuk-!-margin-bottom-1">{{ panel.severity.pluralisedTitle }}</h3>
              <ul class="govuk-list govuk-list--warning">
                {% for flood in panel.floods %}
                  <li><a href="/target-area/{{flood.code}}">{{ flood.description }}</a></li>
                {% endfor %}
              </ul>
            {% endif %}
          {% endfor %}
        </div>
      </details>
    </div>
  </div>
</div>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <figure class="map map--large map--embedded" id="map-now">
      <div class="map__container">
        <div class="map__container-inner">
          {% include "partials/key.html" %}
        </div>
      </div>
      <figcaption class="govuk-visually-hidden">Flood warnings and river and sea levels</figcaption>
    </figure>
    <p class="govuk-body-s govuk-!-margin-top-4">
      <span class="govuk-body--caption">
        <time class="form-hint" title="{{model.timestamp | formatDate}}"
          datetime="{{model.timestamp}}">Last updated {{model.timestamp | formatDate}}</time>
      </span>
    </p>
  </div>
</div>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <div class="govuk-inset-text govuk-inset-text--search govuk-!-margin-top-2">
      <p>
        <a href="/">
          <span class="govuk-inset-text__icon"></span>Check flood warnings and river levels near you
        </a>
      </p>
    </div>
    <div class="govuk-inset-text govuk-!-margin-top-2 govuk-!-margin-bottom-0">
      <p>In river and coastal flood risk areas, you can <a href="https://www.gov.uk/sign-up-for-flood-warnings">get flood warnings by phone, text or email</a>. This service is free.</p>
    </div>
  </div>
</div>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h2 class="govuk-heading-m govuk-!-margin-top-6">Next 5 days</h2>
    <p>{{model.outlook.headline}}</p>
    <!-- <p>{{model.outlook.public_forecast.english_forecast}}</p> -->
    <p>See a <a href="/outlook">map showing the full 5-day outlook</a></p>
  </div>
</div>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h2 class="govuk-heading-m govuk-!-margin-top-6">Long term</h2>
    <p>Many areas are vulnerable to flooding in the future. You can <a href="https://flood-warning-information.service.gov.uk/long-term-flood-risk">learn more about the long term flood risk for any location in England</a>.</p>
  </div>
</div>
{% endblock %}

{% block bodyEnd %}
{{ super() }}
<script src="{{assetPath}}/javascripts/ol.js"></script>
<script src="{{assetPath}}/javascripts/components/maps.js"></script>
<script src="{{assetPath}}/javascripts/components/map-container.js"></script>
<script src="{{assetPath}}/javascripts/components/accordion.js"></script>
<script>
  window.Flood.model = {{ model | dump(2) | safe }}
</script>
<script src="{{assetPath}}/javascripts/outlook.js"></script>
<script src="{{assetPath}}/javascripts/pages/national.js"></script>
{% endblock %}