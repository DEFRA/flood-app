{% extends 'layout.html' %}

{% block content %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <nav class="defra-search-link govuk-!-margin-bottom-7">
      <p class="govuk-body">
        <a href="/">
          <span class="defra-search-link__icon"></span>Check warnings and river levels near you
        </a>
      </p>
    </nav>
  </div>
</div>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-xl">
      Flood risk for England
    </h1>
    <!--
    <div class="govuk-accordion govuk-accordion--defra-target-areas govuk-!-margin-bottom-4" data-module="accordion" id="accordion-default">
      <div class="govuk-accordion__section ">
        <div class="govuk-accordion__section-header">
          <span class="govuk-accordion__section-header-icon"></span>
          <h2 class="govuk-accordion__section-heading">
            <span class="govuk-accordion__section-button" id="accordion-default-heading-1">
              16 Severe flood warnings
            </span>
          </h2>
          <div class="govuk-accordion__section-summary govuk-body govuk-!-margin-top-0" id="accordion-with-summary-sections-summary-1">
            Severe flooding
          </div>
        </div>
        <div id="accordion-default-content-1" class="govuk-accordion__section-content" aria-labelledby="accordion-default-heading-1">
          <p class='govuk-body'>This is the content for Writing well for the web.</p>
        </div>
      </div>
      <div class="govuk-accordion__section ">
        <div class="govuk-accordion__section-header">
          <span class="govuk-accordion__section-header-icon"></span>
          <h2 class="govuk-accordion__section-heading">
            <span class="govuk-accordion__section-button" id="accordion-default-heading-2">
              126 Flood warnings
            </span>
          </h2>
          <div class="govuk-accordion__section-summary govuk-body govuk-!-margin-top-0" id="accordion-with-summary-sections-summary-1">
            Flooding is expected
          </div>
        </div>
        <div id="accordion-default-content-2" class="govuk-accordion__section-content" aria-labelledby="accordion-default-heading-2">
          <p class='govuk-body'>This is the content for Writing well for specialists.</p>
        </div>
      </div>
      <div class="govuk-accordion__section ">
        <div class="govuk-accordion__section-header">
          <span class="govuk-accordion__section-header-icon"></span>
          <h2 class="govuk-accordion__section-heading">
            <span class="govuk-accordion__section-button" id="accordion-default-heading-2">
              240 Flood alerts
            </span>
          </h2>
          <div class="govuk-accordion__section-summary govuk-body govuk-!-margin-top-0" id="accordion-with-summary-sections-summary-1">
            Flooding is possible
          </div>
        </div>
        <div id="accordion-default-content-2" class="govuk-accordion__section-content" aria-labelledby="accordion-default-heading-2">
          <p class='govuk-body'>This is the content for Writing well for specialists.</p>
        </div>
      </div>
    </div>
    -->

    <div class="defra-warning-overview govuk-!-margin-bottom-2">
      {% if model.floods.length %}
        {% for group in model.groups %}
          {% if group.floods %}
            <div class="defra-warning-overview__section">
              <h2 class="defra-warning-overview__section-title">
                <span class="defra-warning-overview__icon defra-warning-overview__icon--{{ group.severity.id }}"></span>
                {{ group.title | lower }}
                <span class="govuk-caption-m">{{ group.severity.subTitle }} - {{ group.severity.tagline }}</span>
              </h2>
            </div>
          {% endif %}
        {% endfor %}
      {% else %}
        <p class="govuk-body">There are currently no flood warnings or alerts in force as of <time class="form-hint" title="{{model.timestamp | formatDate}}"
          datetime="{{model.timestamp}}">{{ model.timestamp | formatDate }}</time>.
        </p>
      {% endif %}
    </div>

    {% if model.floods.length %}
    <div class="app-map">
      <div class="app-map__container">
        <div class="map" id="map-live">
          <div class="map__container">
            <div class="map__container-inner"></div>
          </div>
        </div>
      </div>
    </div>
    <div id="map-list-warnings" class="defra-map-list govuk-!-margin-bottom-4">
      <div id="warnings-detail" class="govuk-details__text govuk-details__text--defra-details-flood">
        {% for group in model.groups %}
          {% if group.floods %}
            <h3 class="govuk-heading-s govuk-!-padding-top-0 govuk-!-margin-bottom-3">
              {{ group.severity.pluralisedTitle }}
              <br/>
              <span class="govuk-!-font-weight-regular">{{group.severity.subTitle}}</span>
            </h3>
            <ul class="defra-list-flood">
              {% for flood in group.floods %}
                <li class="defra-list-flood__item">
                  <a href="/target-area/{{flood.code}}">{{ flood.description }}</a>
                </li>
              {% endfor %}
            </ul>
          {% endif %}
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <div class="govuk-inset-text">
      <p class="govuk-body">If you live near a river or the coast you may be able to <a href="https://www.gov.uk/sign-up-for-flood-warnings">get flood warnings by phone, text or email</a>. This service is free.</p>
    </div>

    <h2 class="govuk-heading-m govuk-!-margin-top-7">
      Flood risk for the next 5 days
    </h2>
    {{ model.outlook | safe }}
    <p class="govuk-body">
      <time class="form-hint" title="{{model.timestampOutlook | formatDate}}"
        datetime="{{ model.timestampOutlook }}">Updated {{ model.timestampOutlook | formatDate }}</time>
    </p>

    {% if model.hasOutlookConcern %}
    <div class="app-map">
      <div class="app-map__container">
        <div class="map" id="map-outlook" hidden>
          <div class="map__container">
            <div class="map__container-inner">
              <div class="map__outlook-control">
                <div class="map__outlook-control__inner">
                  {% for day in model.days %}
                    <div class="map__outlook-control__day">
                      <button class="map__outlook-control__button"
                        aria-selected="{{ "true" if not day.idx else "false" }}"
                        data-day="{{day.idx}}">{{ day.date | formatDate('ddd D') }}
                        <span class="map__outlook-control__icon map__outlook-control__icon--risk-level-{{day.level}}"></span>
                      </button>
                    </div>
                  {% endfor %}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endif %}

    <h2 class="govuk-heading-m govuk-!-margin-top-7">Other ways to check your current flood risk</h2>
    <p class="govuk-body">For river and sea flooding, call the 24-hour Floodline service.</p>
    <p class="govuk-body">
      Telephone: 0345 988 1188<br />
      Type talk: 0345 602 6340 (for the hard of hearing)<br />
      <a class="govuk-link" href="https://gov.uk/call-charges">Find out more about call charges</a>.
    </p>
    <p class="govuk-body">If you are not sure of the source of flooding <a href="https://www.gov.uk/find-local-council">contact your Local Council</a>.</p>
    
  </div>
  <div class="govuk-grid-column-one-third">
    <!-- The Related items component is not part of GOV.UK Frontend but will be styled if used in the Prototype Kit -->
    <aside class="app-related-items" role="complementary" style="border-width:2px">
      <h2 class="govuk-heading-s" id="subsection-title">
        Related content
      </h2>
      <nav role="navigation" aria-labelledby="subsection-title">
        <ul class="govuk-list govuk-!-font-size-16">
          <li>
            <a class="govuk-link" href="/plan-ahead-for-flooding">
              How to plan ahead for flooding
            </a>
          </li>
          <li>
            <a class="govuk-link" href="/what-to-do-in-a-flood/what-the-flood-warnings-mean">
              What to do in a flood
            </a>
          </li>
          <li>
            <a class="govuk-link" href="/recovering-after-a-flood">
              How to recover after a flood
            </a>
          </li>
          <li>
            <a class="govuk-link" href="#">
              View long term flood risk information
            </a>
          </li>
        </ul>
      </nav>
    </aside>
  </div>
</div>

{% endblock %}

{% block bodyEnd %}
{{ super() }}
<script src="{{assetPath}}/javascripts/ol.js"></script>
<script src="{{assetPath}}/javascripts/components/maps.js"></script>
<script src="{{assetPath}}/javascripts/components/maps-styles.js"></script>
<script src="{{assetPath}}/javascripts/components/maps-layers.js"></script>
<script src="{{assetPath}}/javascripts/components/map-container.js"></script>
<script src="{{assetPath}}/javascripts/components/maps/live.js"></script>
<script src="{{assetPath}}/javascripts/components/maps/outlook.js"></script>
<script src="{{assetPath}}/javascripts/templates.js"></script>
<script src="{{ assetPath }}/nunjucks-slim.min.js"></script>
<script>nunjucks.configure()</script>
<script>
  window.flood.model = {{ model | dump(2) | safe }}
</script>
<script src="{{assetPath}}/javascripts/components/map-list.js"></script>
<script src="{{assetPath}}/javascripts/pages/national.js"></script>
{% endblock %}