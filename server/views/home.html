{% extends 'layout.html' %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-xl">Enter a location</h1>
    <form method="post">
      <div class="govuk-form-group">
        <label class="govuk-label govuk-label--m" for="location">City, town or postcode</label>
        <span id="location-hint" class="govuk-hint">For example Bakewell or SW1A 2AA</span>
        <input class="govuk-input govuk-!-width-two-thirds" id="location" name="location" value="" type="text"
          aria-describedby="location-hint">
        <div id="autocomplete-container" class="govuk-body"></div>
      </div>
      <button type="submit" class="govuk-button">Continue</button>
    </form>
  </div>
</div>
{% endblock %}

{% block bodyEnd %}
{{ super() }}
<link rel="stylesheet" href="{{assetPath}}/accessible-autocomplete.min.css" />
<script src="{{assetPath}}/accessible-autocomplete.min.js"></script>
<script>
  function suggest(query, populate) {
    window.Flood.utils.xhr('/suggest?q=' + query, function (err, results) {
      if (err) {
        console.error(err)
        return
      }

      populate(results)
    })
  }

  accessibleAutocomplete({
    element: document.getElementById('autocomplete-container'),
    id: 'location',
    name: 'location',
    source: suggest
  })

  // Remove the original input
  document.getElementById('location').remove()
</script>
{% endblock %}